
<!DOCTYPE html>
<html lang="zh-Hans">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0">
        <title>Go基础学习（伍）——指针 | 小C♥天天</title>
        <meta name="author" content="小C&天天">
        <meta name="description" content="^v^">
        <meta name="keywords" content="">
        <link rel="icon" href="/images/icon.jpg">
        <script src="https://cdn.staticfile.org/instant.page/5.1.0/instantpage.min.js" type="module"></script>
        <script src="https://cdn.staticfile.org/font-awesome/6.1.1/js/all.min.js"></script>
        <link rel="stylesheet" href="/css/fonts.min.css">
        <link rel="stylesheet" href="/css/particlex.css">
        <script src="https://cdn.staticfile.org/vue/3.2.33/vue.global.prod.min.js"></script>
        <script src="https://cdn.staticfile.org/pixi.js/4.6.1/pixi.min.js"></script>
    <meta name="generator" content="Hexo 6.2.0"></head>
    <body>
        <div id="loading" style="height:100vh;width:100vw;position:fixed;display:flex;z-index:200;justify-content:space-between;background:#fff;transition:opacity 0.3s ease-out"><div style="position:fixed;height:100vh;width:100vw;display:flex;justify-content:center;align-items:center"><div id="loadcontent" style="width:30vmin;height:30vmin;padding:60px;border-radius:50%;display:flex;justify-content:center;align-items:center;border:solid 10px #dd20dd;text-align:center"><div><h2>LOADING...</h2><p style="word-break:keep-all">正在加载</p><div><img alt="loading" src="/images/afde9fa65a5742a90b51d6e1211e841e.gif"></div></div></div></div></div>
        <div id="layout">
            <i data-fa-symbol="calendar-solid" class="fa-solid fa-calendar fa-fw"></i>
            <i data-fa-symbol="bookmark-solid" class="fa-solid fa-bookmark fa-fw"></i>
            <i data-fa-symbol="tags-solid" class="fa-solid fa-tags fa-fw"></i>
            <transition name="into">
                <div v-show="show_page" style="display: -not-none">
                    <div id="menu_show">
                         
<nav id="menu">
    <div class="desktop-menu">
        <a href="/">
            <span class="title">小C♥天天</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;主页</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;关于</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;文章</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;分类</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;标签</span>
        </a>
        
    </div>
    <div :class="'phone-menu ' + menu_show" id="phone-menu">
        <div class="curtain" @click="menu_show = !menu_show" v-show="menu_show"></div>
        <div :class="'title'" @click="menu_show = !menu_show">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;小C♥天天</span>
        </div>
        <transition name="slide">
        <div class="items" v-show="menu_show">
            
            <a href="/">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-house fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">主页</div>
                </div>
            </a>
            
            <a href="/about">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-id-card fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">关于</div>
                </div>
            </a>
            
            <a href="/archives">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-box-archive fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">文章</div>
                </div>
            </a>
            
            <a href="/categories">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-bookmark fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">分类</div>
                </div>
            </a>
            
            <a href="/tags">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-tags fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">标签</div>
                </div>
            </a>
            
        </div>
        </transition>
    </div>
</nav>
                    </div>
                    <div id="main">
                        
<div class="article">
    <div>
        <h1>Go基础学习（伍）——指针 </h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <svg class="fa-icon"><use xlink:href="#calendar-solid"></use></svg>
            </span>
            2022/6/18
        </span>
        
        <span class="category">
            <a href="/categories/Go基础教程">
                <span class="icon">
                    <svg class="fa-icon"><use xlink:href="#bookmark-solid"></use></svg>
                </span>
                Go基础教程
            </a>
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <svg class="fa-icon"><use xlink:href="#tags-solid"></use></svg>
            </span>
            
            <span class="tag">
                
                <a href="/tags/开发" style="color: #00a596">
                    开发
                </a>
            </span>
            
            <span class="tag">
                
                <a href="/tags/Go" style="color: #00a596">
                    Go
                </a>
            </span>
            
        </span>
        
    </div>
    <div class="content" v-pre>
        <h1 id="壹-介绍"><a href="#壹-介绍" class="headerlink" title="壹 介绍"></a>壹 介绍</h1><p>Go 语言中指针是很容易学习的，Go 语言中使用指针可以更简单的执行一些任务。Go语言中的指针不能像C&#x2F;C++语言一样进行偏移和运算，是安全指针。要搞明白Go语言中的指针需要先知道3个概念：<font color="red">指针地址、指针类型和指针取值</font>。</p>
<p>任何程序数据载入内存后，在内存都有他们的地址，这个地址就是指针。而为了保存一个数据在内存中的地址，我们就需要一个变量，这个变量就是指针变量。</p>
<span id="more"></span>
<p><font color="red">个人理解：A是一个变量，这个变量存储了一个值是1，那么如果需要得到A在内存的地址，就需要用另一个变量B存储A在内存的地址，这其中，A是存储1的变量，就是普通的变量，B是存储A这个变量在内存的地址的变量，又叫做指针变量，所以指针变量里面存储的只能是内存地址，</font>所以A、B都能指向1这个值，但是A可以直接获取，B要通过A获取，至此我们可以看出指针本身就是一种引用。</p>
<p>那么如何获取地址和地址的值呢？Go语言中有两个符号：<code>&amp;</code>（取地址）和<code>*</code>（根据地址取值）。即，<code>&amp;</code>是B获取A的地址使用的符号，<code>*</code>是B获取1这个值的符号。</p>
<p>语法格式：</p>
<pre><code class="go">// 取地址
b := &amp;a
// a:代表要被获取地址的变量，类型为T
// b:用于接收该a地址的指针变量，b的类型就为*T，称做T的指针类型。*代表这个变量是指针，存储地址的指针变量。
</code></pre>
<p>理解图示：<br><img src="/images/Go%E5%9F%BA%E7%A1%80%E7%BC%96%E7%A8%8B/846d7213e7050dab6241c46bd5a0e295.png" alt="846d7213e7050dab6241c46bd5a0e295.png"><br>实例：</p>
<pre><code class="go">package main
import &quot;fmt&quot;
func main() &#123;
    var a int = 10
    var b *int = &amp;a
    fmt.Printf(&quot;a的值: %v\ta的类型：%T\ta的地址：%p\n&quot;, a, a, &amp;a)
    // a的值: 10       a的类型：int    a的地址：0xc000016098
    fmt.Printf(&quot;b的值: %v\tb的类型：%T\tb的地址：%p\n&quot;, b, b, &amp;b)
    // b的值: 0xc000016098     b的类型：*int   b的地址：0xc000006028
&#125;
</code></pre>
<h1 id="贰-指针声明"><a href="#贰-指针声明" class="headerlink" title="贰 指针声明"></a>贰 指针声明</h1><p><strong>一个指针变量指向了一个值在内存中的地址。</strong> 类似于变量和常量，在使用指针前你需要声明指针。指针声明格式如下：</p>
<pre><code class="go">var 指针变量名 *指针类型
// *号用于指定变量是作为一个指针
</code></pre>
<p>以下是有效的指针声明：</p>
<pre><code class="go">var ip *int        /* 指向整型*/
var fp *float32    /* 指向浮点型 */
</code></pre>
<p><font color="red">需要注意：指针类型只能是值类型，不能是引用类型，这是没有意义的。</font></p>
<h1 id="叁-使用指针"><a href="#叁-使用指针" class="headerlink" title="叁 使用指针"></a>叁 使用指针</h1><p>指针使用流程：</p>
<pre><code class="mermaid">graph LR
A[定义指针变量] --&gt; B[为指针变量赋值,用&amp;] --&gt; C[访问指针变量中指向地址的值,用*]
</code></pre>
<p>例子：</p>
<pre><code class="go">package main

import &quot;fmt&quot;

func main() &#123;
    var a int = 10
    var b *int = &amp;a
    var c **int = &amp;b
    var d ***int = &amp;c
    // 可以看到对于上面的c是指向指针的指针变量，而d是指向指针的指针的指针变量，大概懂那个意思就行，每一次都加一个*
    fmt.Printf(&quot;a的值: %v\ta的类型：%T\ta的地址：%p\n&quot;, a, a, &amp;a)
    // a的值: 10       a的类型：int    a的地址：0xc000016098
    fmt.Printf(&quot;b的值: %v\tb的类型：%T\tb的地址：%p\n&quot;, b, b, &amp;b)
    // b的值: 0xc000016098     b的类型：*int   b的地址：0xc000006028
    fmt.Printf(&quot;获取b指针的值: %v\n&quot;, *b)
    // 获取b指针的值: 10
    fmt.Printf(&quot;c的值: %v\tc的类型：%T\tc的地址：%p\n&quot;, c, c, &amp;c)
    // c的值: 0xc000006028     c的类型：**int  c的地址：0xc000006030
    fmt.Printf(&quot;获取c指针的值: %v\t获取c指针的指针的值: %v\n&quot;, *c, **c)
    // 获取c指针的值: 0xc000016098     获取c指针的指针的值: 10
    fmt.Printf(&quot;d的值: %v\td的类型：%T\td的地址：%p\n&quot;, d, d, &amp;d)
    // d的值: 0xc000006030     d的类型：***int d的地址：0xc000006038
    fmt.Printf(&quot;获取d指针的值: %v\t获取d指针的指针的值: %v\t获取d指针的指针的指针的值: %v\n&quot;, *d, **d, ***d)
    // 获取d指针的值: 0xc000006028     获取d指针的指针的值: 0xc000016098       获取d指针的指针的指针的值: 10
&#125;
</code></pre>
<h1 id="肆-空指针"><a href="#肆-空指针" class="headerlink" title="肆 空指针"></a>肆 空指针</h1><p>当一个指针被定义后没有分配到任何变量时，它的值为 nil，nil 指针也称为空指针，nil在概念上和其它语言的null、None、nil、NULL一样，都指代零值或空值，这时候是不可以给该指针常用类型的值的，如：int、float、bool、string等，<font color="red">指针变量只能存储地址</font>。</p>
<pre><code class="go">package main
import &quot;fmt&quot;
func main() &#123;
   var ptr *int
   fmt.Printf(&quot;ptr 的值为 : %x\n&quot;, ptr  )
    //ptr 的值为 : 0
&#125;
</code></pre>
<h1 id="伍-指针数组"><a href="#伍-指针数组" class="headerlink" title="伍 指针数组"></a>伍 指针数组</h1><p>需要将数组保存到指针中，我们可以对整型指针数组进行以下声明：</p>
<pre><code class="go">var ptr [MAX]*int;
// ptr:是指针数组
// MAX是指针数组的数量
// *int:指针数组的类型
</code></pre>
<p>ptr 为整型指针数组。因此每个元素都指向了一个值。以下实例的三个整数将存储在指针数组中：</p>
<pre><code class="go">package main
import &quot;fmt&quot;
// 定义一个MAX，是方便统一管理数组的数量
const MAX int = 3
func main() &#123;
   a := []int&#123;10,100,200&#125;
   var i int
   var ptr [MAX]*int;
   for i = 0; i &lt; MAX; i++ &#123;
      ptr[i] = &amp;a[i] /* 整数地址赋值给指针数组 */
   &#125;
   for i = 0; i &lt; MAX; i++ &#123;
      fmt.Printf(&quot;a[%d]地址 = %d，a[%d]值 = %d，\n&quot;, i, ptr[i], i, *ptr[i])
   &#125;
&#125;
</code></pre>
<p><img src="/images/Go%E5%9F%BA%E7%A1%80%E7%BC%96%E7%A8%8B/e8be461173cea8e1909072746ab21386.png" alt="e8be461173cea8e1909072746ab21386.png"><br><font color="red">可以看到数组是引用类型，*号不在数组前面定义而是在其类型上定义。</font></p>
<h1 id="陆-指针作为函数参数"><a href="#陆-指针作为函数参数" class="headerlink" title="陆 指针作为函数参数"></a>陆 指针作为函数参数</h1><p>Go 语言允许向函数传递指针，只需要在函数定义的参数上设置为指针类型即可。</p>
<p>以下实例演示了如何向函数传递指针，并在函数调用后修改函数内的值：</p>
<pre><code class="go">package main
import &quot;fmt&quot;
func main() &#123;
   /* 定义局部变量 */
   var a int = 100
   var b int= 200
   fmt.Printf(&quot;交换前 a 的值 : %d\n&quot;, a )
   fmt.Printf(&quot;交换前 b 的值 : %d\n&quot;, b )
   /* 调用函数用于交换值
   * &amp;a 指向 a 变量的地址
   * &amp;b 指向 b 变量的地址
   */
   swap(&amp;a, &amp;b);
   fmt.Printf(&quot;交换后 a 的值 : %d\n&quot;, a )
   fmt.Printf(&quot;交换后 b 的值 : %d\n&quot;, b )
&#125;
func swap(x *int, y *int) &#123;
   var temp int
   temp = *x    /* 保存 x 地址的值 */
   *x = *y      /* 将 y 赋值给 x */
   *y = temp    /* 将 temp 赋值给 y */
&#125;
</code></pre>
<p><img src="/images/Go%E5%9F%BA%E7%A1%80%E7%BC%96%E7%A8%8B/20eefe5dc5abab9542a34edcf223a7c1.png" alt="20eefe5dc5abab9542a34edcf223a7c1.png"></p>
<h1 id="柒-new和make"><a href="#柒-new和make" class="headerlink" title="柒 new和make"></a>柒 new和make</h1><p>我们先来看一个例子：</p>
<pre><code class="go">func main() &#123;
    var a *int
    *a = 100
    // 为什么可以b := 100,a = &amp;b呢？
    // 个人理解是因为a=&amp;b表示&amp;b讲地址的值赋值给a，而*a=100，表示不能直接将100给*a，因为*a本身没有存储100的地址，需要申请一块存储100的地址，才能存储100
    fmt.Println(*a)

    var b map[string]int
    b[&quot;A7&quot;] = 100
    fmt.Println(b)
&#125;
</code></pre>
<p>执行上面的代码会引发panic，为什么呢？ 在Go语言中对于引用类型的变量，我们在使用的时候不仅要声明它，还要为它分配内存空间，否则我们的值就没办法存储。而对于值类型的声明不需要分配内存空间，是因为它们在声明的时候已经默认分配好了内存空间。要分配内存，就引出来今天的new和make。 Go语言中new和make是内建的两个函数，主要用来分配内存。</p>
<h2 id="7-1-new"><a href="#7-1-new" class="headerlink" title="7.1 new"></a>7.1 new</h2><p>new是一个内置的函数，是用于内存分配的，与make差不多，不过make<font color="red">只用于slice、map以及chan的内存创建，而且它返回的类型就是这三个类型本身，而不是他们的指针类型</font>，因为这三种类型就是引用类型，所以就没有必要返回他们的指针了。，它的函数格式如下：</p>
<pre><code class="go">func new(Type)	*Type
// Type：表示类型，new函数只接受一个参数，这个参数是一个类型
//*Type：表示类型指针，new函数返回一个指向该类型内存地址的指针。
</code></pre>
<p>new函数不太常用，使用new函数得到的是<font color="red">一个类型的指针，并且该指针对应的值为类型零值</font>。举个例子：</p>
<pre><code class="go">func main() &#123;
    a := new(int)
    b := new(bool)
    fmt.Printf(&quot;%T\n&quot;, a) // *int
    fmt.Printf(&quot;%T\n&quot;, b) // *bool
    fmt.Println(*a)       // 0
    fmt.Println(*b)       // false
&#125;
</code></pre>
<p>而<code>var a *int</code>只是声明了一个指针变量a，但是没有初始化，指针作为引用类型需要初始化后才会拥有内存空间，才可以给它赋值。应该按照如下方式使用内置的new函数对a进行初始化之后就可以正常对其赋值了：</p>
<pre><code class="go">func main() &#123;
    var a *int
    a = new(int)
    *a = 10
    fmt.Println(*a)
&#125;
</code></pre>
<h2 id="7-2-new与make的区别"><a href="#7-2-new与make的区别" class="headerlink" title="7.2 new与make的区别"></a>7.2 new与make的区别</h2><p>a.  二者都是用来做内存分配的<br>b.  make只用于slice、map以及channel的初始化，会被编译器翻译成具体的创建函数，由其分配内存和初始化成员结构，<font color="red">返回的还是这三个引用类型本身</font>，new是代替不了make的<br>c.  而new用于类型的内存分配，并且内存对应的值为类型零值，<font color="red">返回的是指向类型的指针</font></p>
<h1 id="捌-什么情况下使用指针（注意）"><a href="#捌-什么情况下使用指针（注意）" class="headerlink" title="捌 什么情况下使用指针（注意）"></a>捌 什么情况下使用指针（注意）</h1><ul>
<li>a.不要对 map、slice、channel 这类引用类型使用指针；</li>
<li>b.如果需要修改参数的值或者内部数据时，也需要使用指针类型的参数；</li>
<li>c.如果是比较大的数据类型时，每次参数传递或者调用方法都要内存拷贝，内存占用多，这时候可以考虑使用指针；</li>
<li>d.像 int、bool 这样的小数据类型没必要使用指针；</li>
<li>e.如果需要并发安全，则尽可能地不要使用指针，使用指针一定要保证并发安全；</li>
<li>f.指针最好不要嵌套，也就是不要使用一个指向指针的指针，虽然 Go 语言允许这么做，但是这会使你的代码变得异常复杂。</li>
</ul>

    </div>
    
</div>
                         
<footer id="footer">
    <div class="footer-wrap">
        <div>
            © 2022 - 2022 小C♥天天
            <span class="footer-icon">
                <i class="fa-brands fa-github fa-fw"></i>
            </span>
            @小C&天天
        </div>
        <div>
            备案号：小C&天天の窝
        </div>
    </div>
</footer>
                    </div>
                </div>
            </transition>
            <div id="img_show">
                <img id="img_content" alt="img_show">
            </div>
        </div>
        <script src="https://cdn.staticfile.org/highlight.js/11.5.1/highlight.min.js"></script>
        <script src="/js/particlex.js"></script>
        <script src="/js/showimg.js"></script>
        

        <!-- 3D模型 -->
        <div id="L2dCanvas" style="position: relative;"></div>
        <script src="/js/live2d.min.js"></script>
        <script src="/css/live2d.css"></script>
        <script>
            var v = new Viewer({
                basePath: "/model",
                role: "zhala_2",
                mobile: true,
            });
        </script>
        <!-- 点击 -->
        <script>
            let body = document.getElementsByTagName('body')[0];
            body.addEventListener('click', (e) => {
                let contentArr = ['✊','😘','😍','😊','😭','😡','😋','👍','🐷','😱','💷','💵','×','🆗','№','⭐','🌙','♥','💴','☀','🐎','🐂','🐏','√'];
                let randomNum = function (n) {
                    return Math.floor(Math.random() * n)
                }
                let span = document.createElement('span');
                span.innerHTML = `${contentArr[randomNum(contentArr.length)]}`;
                span.style.color = `rgb(${randomNum(256)},${randomNum(256)},${randomNum(256)})`;
                span.style.position = 'absolute';
                span.style.top = `${e.pageY}px`;
                span.style.left = `${e.pageX}px`;
                span.style.transition = 'all 1s ease';
                span.style.zIndex = 20000;
                body.appendChild(span)
                setTimeout(()=>{
                    span.style.top = span.offsetTop - 100 + 'px';
                    span.style.opacity = 0;
                    setTimeout(()=>{span.remove()},700)
                },0)
            })
        </script>
        <!-- 流星背景特效 -->
        <canvas id="background" style="position:fixed;top:0;left:0;width:100vw;height:100vh;pointer-events:none;z-index:-1"></canvas>
        <script src="/js/background.js"></script>
    </body>
</html>